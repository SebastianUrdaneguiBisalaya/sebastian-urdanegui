---
import BlogLayout from "@layouts/BlogLayout.astro";
import { marked } from "marked";

const lang = Astro.currentLocale;

export async function getStaticPaths() {
    return [{
        params: {
            id: "1"
        }
    }]
}

const { id } = Astro.params;
const response = await fetch(`/api/blog/${id}`);
let post;
if (response.ok) {
    post = await response.json();
} else {
    return Astro.redirect("/404");
}
const parsedContent = marked(post.content);
---

<BlogLayout title={post.title}>
    <article class="w-full flex flex-col gap-4">
        <h1 class="font-sora text-dark dark:text-white font-bold text-2xl w-full">{post.title}</h1>
        <p class="font-reddit font-medium text-dark/80 dark:text-gray-200 w-full">{lang === "en" ? `Written by ${post.author}` : `Escrito por ${post.author}`}</p>
        <div class="flex flex-row items-center justify-between w-full gap-4">
            <p class="font-reddit text-dark/60 dark:text-gray-300 text-xs w-full">{post.date}</p>
            <div class="flex flex-row items-center gap-2">
                <span class="opacity-50">
                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 32 32"><path fill="currentColor" d="M30.94 15.66A16.69 16.69 0 0 0 16 5A16.69 16.69 0 0 0 1.06 15.66a1 1 0 0 0 0 .68A16.69 16.69 0 0 0 16 27a16.69 16.69 0 0 0 14.94-10.66a1 1 0 0 0 0-.68M16 25c-5.3 0-10.9-3.93-12.93-9C5.1 10.93 10.7 7 16 7s10.9 3.93 12.93 9C26.9 21.07 21.3 25 16 25"/><path fill="currentColor" d="M16 10a6 6 0 1 0 6 6a6 6 0 0 0-6-6m0 10a4 4 0 1 1 4-4a4 4 0 0 1-4 4"/></svg>
                </span>
                <p class="font-reddit text-dark/60 dark:text-gray-300 text-xs w-full">{post.views}</p>
            </div>
        </div>
        <div class="prose dark:prose-invert" set:html={parsedContent} />
    </article>
</BlogLayout>